<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/b199ddb6a4.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <title>todoList</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css'%}">
</head>
<body>
    <div class="event-message hide">
       <i class="far fa-check-circle"></i>
       <span>TODO Added</span>
       <i class="fas fa-times"></i>
   </div>
    <div class="alert alert-info" role="alert">
         A simple info alert—check it out!
    </div>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    <div class="container">
        <div class="header grid">
            <div class="title">Title</div>
            <div class="filter">
                <i class="fas fa-filter"></i>
               <div class="filter-form hide">
                   <form class ="form-filter-center">
                       <input type="checkbox" id="filter-check">
                       <label for="filter-check">Приховати виконані</label>
                   </form>
               </div>
            </div>
            <div class="date">Date</div>
            <div class="action">Action</div>
        </div>
        <div class="todolist">
            {% block item %}
            {% for a in todo_item_list%}
            <div class="todoitem">
                <div class="itemTitle {{a.item_done}}"><span> {{a.item_title}} </span></div>
                <div class="itemDate {{a.item_done}}"><span>{{a.item_data}}</span></div>
                <div class="itemAction">
                    <div>
                        <a href="{% url 'todoapp:complete_item' a.id %}" class="complete Btn">Complete</a>
                    </div>
                    <br>
                    <div>
                        <a href="{% url 'todoapp:delete_item' a.id %}" class="delete Btn" >Delete</a>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endblock %}
            <br>
        </div>
        <div class="pagination">
            {% if todo_item_list.has_previous %}
            <a class="PrevBtn" href="{% url 'todoapp:_index_' %}?page={{todo_item_list.previous_page_number}}"><</a>
            {% endif %}
            {% block pagin %}
            {% for p in todo_item_list.page_range %}
            <a class="PageBtn" href="{% url 'todoapp:_index_' %}?page={{p}}">{{p}}</a>
            {% endfor %}
            {% endblock %}
            <span class="current">
                Page {{ todo_item_list.number }} of {{ todo_item_list.paginator.num_pages }}.
            </span>
            {% if todo_item_list.has_next %}
            <a class="NextBtn" href="{% url 'todoapp:_index_' %}?page={{todo_item_list.next_page_number}}">></a>
            {% endif %}
        </div>
        {% block add%}
        <div class="addtodoitem">
            <h3 class="headerAdd">Add TODO item</h3>
            <form action="{% url 'todoapp:additem' %}"  method="POST" class="addForm">

                {% csrf_token %}
            <div class="all-input">
                <label for="titletext">Title:</label>
                <input type="text" id="titletext" name = "item_title" style="width: 35%;">
                <div class="dataContent hide">
                    <label for="date">Select a date:</label>
                    <input type="date" name="date" id="date" >
                </div>
            </div>
                <br>
                <input type="submit" value="Add TODO" class="addBtn">
            </form>
        </div>
        {% endblock %}
    </div>
<script defer>
let filter = document.querySelector("#filter-check");
    filter.addEventListener('change', () =>{
        let items = document.querySelectorAll(".todoitem");
        if (filter.checked == true){
            items.forEach(el =>{
                if (el.childNodes[1].classList.contains("done")) {
                    el.classList.add("hide")
                    }
                })
            }
        else {
            items.forEach(el =>{
                if (el.childNodes[1].classList.contains("done")){
                    el.classList.remove("hide")
                }
        })
    }
})

let titleInput = document.getElementById('titletext');
let dataContent = document.getElementsByClassName('dataContent')[0]
titleInput.addEventListener('input', ()=>{
    if (titleInput.value.length >= 5){
        if (dataContent.classList.contains("hide")){
            dataContent.classList.remove("hide")
        }
    } else{
        if (!dataContent.classList.contains("hide")){
            dataContent.classList.add("hide")
        }
    }
})

let addBtn = document.getElementsByClassName('addBtn')[0]
function hideMessage() {
    document.getElementsByClassName('event-message')[0].classList.add("hide");
  }
addBtn.addEventListener('click', (evt)=>{
    document.getElementsByClassName('event-message')[0].classList.remove("hide");
    setTimeout(hideMessage, 2000)
})
let filterClick = document.getElementsByClassName('filter')[0]
let hideElem = document.getElementsByClassName('filter-form')[0]

filterClick.addEventListener('click', ()=>{
    if (hideElem.classList.contains("hide")){
        hideElem.classList.remove("hide")
    } else{
    if (!hideElem.classList.contains("hide")){
        hideElem.classList.add("hide")
    }
    }
})

<!--function submitForm() {-->
<!--    var http = new XMLHttpRequest();-->
<!--    http.open("POST", "<<whereverTheFormIsGoing>>", true);-->
<!--    http.setRequestHeader("Content-type","application/x-www-form-urlencoded");-->
<!--    var params = "search=" + <<get search value>>; // probably use document.getElementById(...).value-->
<!--    http.send(params);-->
<!--    http.onload = function() {-->
<!--        alert(http.responseText);-->
<!--    }-->
<!--}-->
var alertNode = document.querySelector('.alert')
var alert = bootstrap.Alert.getInstance(alertNode)
alert.close()

</script>
</body>
</html>